/*NORMALIZE DATA*/

use proyecto2;

DELIMITER $$
CREATE PROCEDURE INSERT_CONTINET()
BEGIN
	INSERT INTO Continente(nombre) 
    (SELECT DISTINCT REGION_PADRE FROM carga3);
END;
$$
CALL

DELIMITER $$
CREATE PROCEDURE INSERT_REGION()
BEGIN
	INSERT INTO Region(nombre, idContinente) 
    (SELECT nombre_region, (SELECT id FROM continente WHERE nombre = C3.REGION_PADRE) as continente FROM carga3 AS C3);
END;
$$

DELIMITER $$
CREATE PROCEDURE INSERT_PAIS()
BEGIN
	INSERT INTO Pais(nombre, poblacion, area, capital, region) 
    SELECT DISTINCT PAIS_DEL_INVENTOR, CAST(POBLACION_DEL_PAIS AS DECIMAL(12,2)) as POBLACION_DEL_PAIS,
	CAST(AREA_EN_KM2 AS DECIMAL(12,2)) as AREA_EN_KM2, CAPITAL, (SELECT id FROM region WHERE nombre = REGION_DEL_PAIS) as id   FROM TEMP T;
END;
$$

DELIMITER $$
CREATE PROCEDURE INSERT_FRONTERA()
BEGIN
	INSERT INTO Frontera(norte, sur, este, oeste, pais, front) 
    SELECT DISTINCT PAIS_DEL_INVENTOR, CAST(POBLACION_DEL_PAIS AS DECIMAL(12,2)) as POBLACION_DEL_PAIS,
	CAST(AREA_EN_KM2 AS DECIMAL(12,2)) as AREA_EN_KM2, CAPITAL, (SELECT id FROM region WHERE nombre = REGION_DEL_PAIS) as id   FROM TEMP T;
END;
$$


SELECT DISTINCT PAIS_DEL_INVENTOR, FRONTERA_CON FROM TEMP T
WHERE PAIS_DEL_INVENTOR != "";





SELECT * FROM Temp where PAIS_DEL_INVENTOR ="";

select * from temp where id = 1400;
